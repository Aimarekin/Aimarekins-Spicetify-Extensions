!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var o,l,I,p,R,c,A,d,B,H,q,e,t,i,s,a,r,U,z,n,m,f,W,X,u;o=Object.create,l=Object.defineProperty,I=Object.defineProperties,p=Object.getOwnPropertyDescriptor,R=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,A=Object.getOwnPropertySymbols,d=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,q=(e,t,i)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,t=(e,t,i)=>{i=null!=e?o(d(e)):{};var a=!t&&e&&e.__esModule?i:l(i,"default",{value:e,enumerable:!0}),r=e,s=void 0,n=void 0;if(r&&"object"==typeof r||"function"==typeof r)for(let e of c(r))B.call(a,e)||e===s||l(a,e,{get:()=>r[e],enumerable:!(n=p(r,e))||n.enumerable});return a},i=(e=(e,t)=>function(){return t||(0,e[c(e)[0]])((t={exports:{}}).exports,t),t.exports})({"external-global-plugin:react"(e,t){t.exports=Spicetify.React}}),e=e({"external-global-plugin:react-dom"(e,t){t.exports=Spicetify.ReactDOM}}),s={svg:"http://www.w3.org/2000/svg",path:"http://www.w3.org/2000/svg"},a="en",r={en:{skip_after_timestamp:"Skip after Timestamp",percentage_mode_setting:"Percentage mode - Skip tracks based on percentage completed instead of a timestamp",will_skip_after_time:"Tracks will now be skipped after {0}",will_skip_after_percentage:"Tracks will now be skipped after {0} completed",future_skip_after_time:"Future tracks will now be skipped after {0}",future_skip_after_percentage:"Future tracks will now be skipped after {0} completed",this_skip_after_time:"This track will now be skipped after {0}",this_skip_after_percentage:"This track will now be skipped after {0} completed",disabled_auto_skip:"Disabled auto skip",disabled_once:"Will not skip this track once"},es:{skip_after_timestamp:"Saltar Después de",percentage_mode_setting:"Modo de porcentaje - Salta la canción después de que se haya reproducido un porcentaje en vez de una duración",will_skip_after_time:"Se reproducirá la siguiente canción tras {0}",will_skip_after_percentage:"Se reproducirá la siguiente canción tras reproducir el {0}",future_skip_after_time:"Las siguientes canciones se reproducirán tras {0}",future_skip_after_percentage:"Las siguientes canciones se reproducirán tras reproducir el {0}",this_skip_after_time:"Se reproducirá la siguiente canción tras {0}",this_skip_after_percentage:"Se reproducirá la siguiente canción tras reproducir el {0}",disabled_auto_skip:"Siguiente reproducción automática desactivada",disabled_once:"Esta canción no se saltará automáticamente"}},U=e=>Math.floor(e/6e4)+":"+Math.floor(e%6e4/1e3).toString().padStart(2,"0"),z=(e,t=!1)=>`${t?100*e:Math.floor(100*e)}%`,n=e=>"string"!=typeof e||e.match(/[^\d.]/)?NaN:parseFloat(e.trim().replace(",",".")),m=t(i()),f=t(e()),W=class{constructor(e,t,i={}){this.name=e,this.settingsId=t,this.initialSettingsFields=i,this.settingsFields=this.initialSettingsFields,this.setRerender=null,this.pushSettings=async()=>{for(Object.entries(this.settingsFields).forEach(([e,t])=>{"button"!==t.type&&void 0===this.getFieldValue(e)&&this.setFieldValue(e,t.defaultValue)});!Spicetify?.Platform?.History?.listen;)await new Promise(e=>setTimeout(e,100));this.stopHistoryListener&&this.stopHistoryListener(),this.stopHistoryListener=Spicetify.Platform.History.listen(e=>{"/preferences"===e.pathname&&this.render()}),"/preferences"===Spicetify.Platform.History.location.pathname&&await this.render()},this.rerender=()=>{this.setRerender&&this.setRerender(Math.random())},this.render=async()=>{for(;!document.getElementById("desktop.settings.selectLanguage");){if("/preferences"!==Spicetify.Platform.History.location.pathname)return;await new Promise(e=>setTimeout(e,100))}var e=document.querySelector(".main-view-container__scroll-node-child main div");if(!e)return console.error("[spcr-settings] settings container not found");let t=Array.from(e.children).find(e=>e.id===this.settingsId);t?console.log(t):((t=document.createElement("div")).id=this.settingsId,e.appendChild(t)),f.default.render(m.default.createElement(this.FieldsContainer,null),t)},this.addButton=(e,t,i,a,r)=>{this.settingsFields[e]={type:"button",description:t,value:i,events:{onClick:a,...r}}},this.addInput=(e,t,i,a,r,s)=>{this.settingsFields[e]={type:"input",description:t,defaultValue:i,inputType:r,events:{onChange:a,...s}}},this.addHidden=(e,t)=>{this.settingsFields[e]={type:"hidden",defaultValue:t}},this.addToggle=(e,t,i,a,r)=>{this.settingsFields[e]={type:"toggle",description:t,defaultValue:i,events:{onChange:a,...r}}},this.addDropDown=(e,t,i,a,r,s)=>{this.settingsFields[e]={type:"dropdown",description:t,defaultValue:i[a],options:i,events:{onSelect:r,...s}}},this.getFieldValue=e=>JSON.parse(Spicetify.LocalStorage.get(this.settingsId+"."+e)||"{}")?.value,this.setFieldValue=(e,t)=>{Spicetify.LocalStorage.set(this.settingsId+"."+e,JSON.stringify({value:t}))},this.FieldsContainer=()=>{var[e,t]=(0,m.useState)(0);return this.setRerender=t,m.default.createElement("div",{className:"x-settings-section",key:e},m.default.createElement("h2",{className:"TypeElement-cello-textBase-type"},this.name),Object.entries(this.settingsFields).map(([e,t])=>m.default.createElement(this.Field,{nameId:e,field:t})))},this.Field=i=>{var e=this.settingsId+"."+i.nameId;let t;if(t="button"===i.field.type?i.field.value:this.getFieldValue(i.nameId),"hidden"===i.field.type)return m.default.createElement(m.default.Fragment,null);const[a,r]=(0,m.useState)(t),s=e=>{void 0!==e&&(r(e),this.setFieldValue(i.nameId,e))};return m.default.createElement("div",{className:"x-settings-row"},m.default.createElement("div",{className:"x-settings-firstColumn"},m.default.createElement("label",{className:"TypeElement-viola-textSubdued-type",htmlFor:e},i.field.description||"")),m.default.createElement("div",{className:"x-settings-secondColumn"},"input"===i.field.type?m.default.createElement("input",{className:"x-settings-input",id:e,dir:"ltr",value:a,type:i.field.inputType||"text",...i.field.events,onChange:e=>{s(e.currentTarget.value);var t=i.field.events?.onChange;t&&t(e)}}):"button"===i.field.type?m.default.createElement("span",null,m.default.createElement("button",{id:e,className:"Button-sm-buttonSecondary-isUsingKeyboard-useBrowserDefaultFocusStyle x-settings-button",...i.field.events,onClick:e=>{s();var t=i.field.events?.onClick;t&&t(e)},type:"button"},a)):"toggle"===i.field.type?m.default.createElement("label",{className:"x-settings-secondColumn x-toggle-wrapper"},m.default.createElement("input",{id:e,className:"x-toggle-input",type:"checkbox",checked:a,...i.field.events,onClick:e=>{s(e.currentTarget.checked);var t=i.field.events?.onClick;t&&t(e)}}),m.default.createElement("span",{className:"x-toggle-indicatorWrapper"},m.default.createElement("span",{className:"x-toggle-indicator"}))):"dropdown"===i.field.type?m.default.createElement("select",{className:"main-dropDown-dropDown",id:e,...i.field.events,onChange:e=>{s(i.field.options[e.currentTarget.selectedIndex]);var t=i.field.events?.onChange;t&&t(e)}},i.field.options.map((e,t)=>m.default.createElement("option",{selected:e===a,value:t+1},e))):m.default.createElement(m.default.Fragment,null)))}}},String.prototype.formatUnicorn=String.prototype.formatUnicorn||function(){let t=this.toString();if(arguments.length){var i=typeof arguments[0];let e;var a="string"==i||"number"==i?Array.prototype.slice.call(arguments):arguments[0];for(e in a)t=t.replace(new RegExp("\\{"+e+"\\}","gi"),a[e])}return t},X=()=>{var e=Spicetify.Player.data;for(const t of["playbackId","playback_id"])if(void 0!==e[t])return e[t]},u=async function(){for(;!(null!=Spicetify&&Spicetify.Player&&null!=Spicetify&&Spicetify.Locale&&null!=Spicetify&&Spicetify.showNotification&&null!=Spicetify&&Spicetify.CosmosAsync);)await new Promise(e=>setTimeout(e,100));try{Spicetify.CosmosAsync.sub("sp://player/v2/main",e=>{e.playback_id!==X()||void 0===(e=e.position_as_of_timestamp)||e<1e3||e>=S()&&N(!1)})}catch(e){console.error(e)}const i=new W(Y("skip_after_timestamp"),"skip-after-timestamp",{"percentage-mode":{type:"toggle",description:Y("percentage_mode_setting"),defaultValue:!1,events:{onChange:()=>{var e,t;e=i.getFieldValue("percentage-mode"),t=!0,e!==b()&&(w()?e?P(_(),t):L(S(),t):F(e,t))}}}}),s=(await i.pushSettings(),n=".playback-progressbar",o=document.body,p=!(l=5e3),await new Promise((t,e)=>{let i;0<l&&(i=setTimeout(()=>{if(p)return e("Did not find element after timeout.");console.warn("waitForElm has waited for",l," for selector",n,"within",o,"but it has not yet been found.")},l));var a=o.querySelector(n);if(a)return t(a);const r=new MutationObserver(()=>{var e=o.querySelector(n);if(e)return r.disconnect(),clearTimeout(i),t(e)});r.observe(o,{childList:!0,subtree:!0})}));var n,o,l,p;const c=J("div",{className:"skip-after-timestamp-marker"},J("div",{className:"skip-after-timestamp-container"},J("button",{className:"skip-after-timestamp-button",type:"button"}))),d=(document.body.appendChild(c),["left","top","right","bottom"]),m=Array(d.length).fill(null);!function e(){var t,i,a=s.getBoundingClientRect();for([t,i]of d.entries()){var r=a[i];r!==m[t]&&(c.style.setProperty("--skip-after-timestamp-playback-"+i,r+"px"),m[t]=r)}requestAnimationFrame(e)}(),c.addEventListener("mousedown",e=>{const s=e.clientX,n=e.clientY;function o(e){window.removeEventListener("mousemove",l),c.contains(e.target)&&(e.preventDefault(),0===e.button?(E(!0),Spicetify.showNotification(Y("disabled_auto_skip")),c.classList.remove("skip-after-timestamp-active")):2===e.button&&N(!t(),!0))}function l(e){var t,i,a,r;t=s,i=n,a=e.clientX,r=e.clientY,8<Math.sqrt(Math.pow(a-t,2)+Math.pow(r-i,2))&&(D(e),window.removeEventListener("mouseup",o),window.removeEventListener("mousemove",l))}window.addEventListener("mouseup",o,{once:!0}),window.addEventListener("mousemove",l)}),e=((e,t)=>{for(var i in t=t||{})B.call(t,i)&&q(e,i,t[i]);if(A)for(var i of A(t))H.call(t,i)&&q(e,i,t[i]);return e})({},Spicetify.TippyProps);var e=I(e,R({interactive:!0,interactiveBorder:30}));const r=Spicetify.Tippy(c,e),a=J("input",{className:"skip-after-timestamp-input",type:"text"}),f=(r.popper.querySelector(".main-contextMenu-tippy").appendChild(a),a.addEventListener("focusout",e=>{var i=a.value;if(""!==i){a.value=f();let e=(b()?G:$)(i),t=b();null===e&&(t=!t,e=(b()?$:G)(i)),null!==e&&(t?z:U)(e)!==f()&&(t?P:L)(e,!0)}}),a.addEventListener("keypress",e=>{"Enter"===e.key&&a.blur()}),()=>b()?z(_()):U(S())),u=(e,t=Spicetify.Player.getDuration())=>e*t;let g,y,k,h,v;const w=()=>!0===g,t=()=>!0===y,b=()=>!0===k,S=()=>b()?u(v):h,_=()=>{return b()?v:(e=h,t=Spicetify.Player.getDuration(),e/t);var e,t};function E(e=!1){w()&&(N(!(g=!1)),c.classList.remove("skip-after-timestamp-active"),e)&&Spicetify.showNotification(Y("disabled_auto_skip"))}function x(e=!1){e=e?"this":t()?"will":"future";b()?Spicetify.showNotification(Y(e+"_skip_after_percentage").formatUnicorn(z(_()))):Spicetify.showNotification(Y(e+"_skip_after_time").formatUnicorn(U(S())))}function L(e,t=!1){!b()&&e===S()||(r.hide(),c.classList.add("skip-after-timestamp-active"),c.classList.add("skip-after-timestamp-duration-mode"),c.classList.remove("skip-after-timestamp-percentage-mode"),F(!(g=!0)),h=e,C(),O()&&N(!1),U(e),t&&x(),a.value=U(e))}function P(e,t=!1){b()&&e===_()||(r.hide(),c.classList.add("skip-after-timestamp-active"),c.classList.remove("skip-after-timestamp-duration-mode"),c.classList.add("skip-after-timestamp-percentage-mode"),F(g=!0),v=e,C(),O()&&N(!1),z(e),t&&x(),a.value=z(e))}const j=(e,t=!1)=>b()?P(e,t):L(u(e),t);function N(e,t=!1){e!==y&&(y=e,c.classList[e?"remove":"add"]("skip-after-timestamp-dont-skip-this-playback"),t)&&(e?x(!0):Spicetify.showNotification(Y("disabled_once")))}function F(e,t=!1){e!==b()&&(k=e,i.setFieldValue("percentage-mode",e),c.classList[e?"add":"remove"]("skip-after-timestamp-percentage-mode"),t)&&w()&&x()}function C(e=_()){c.style.setProperty("--skip-after-timestamp-set",e.toString()),c.classList[1<e?"add":"remove"]("skip-after-timestamp-overflow")}E(),N(!0),F(i.getFieldValue("percentage-mode"));const O=()=>b()?Spicetify.Player.getProgressPercent()>=v:Spicetify.Player.getProgress()>=h;let T=!1;function D(i){if(Spicetify.Player.origin.getState().hasContext&&!T){T=!0,r.disable();const a=e=>c.style.setProperty("--skip-after-timestamp-drag",K(e,s).toString());c.classList.add("skip-after-timestamp-dragging"),a(i),window.addEventListener("mousemove",a),window.addEventListener("mouseup",function e(t){t.button===i.button&&(window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",e),T=!1,r.enable(),c.classList.remove("skip-after-timestamp-dragging"),t=K(t,s),j(t,!0))})}}s.addEventListener("mousedown",e=>{2===e.button&&D(e)});let M=void 0,V=!1;Spicetify.Player.addEventListener("onprogress",()=>{var e;Spicetify.Player.origin.getState().hasContext?((e=X())!==M&&(M=e,N(!0),V=!1,C()),V||w()&&t()&&O()&&1e3<Spicetify.Player.getProgress()&&!T&&(Spicetify.Player.isPlaying()?(V=!0,Spicetify.Player.next()):N(!1))):E()}),console.log("Loaded skip-after-timestamp")},(async()=>{await u()})();function J(e,t,...i){if("function"==typeof e)return e(t,...i);var a=t.xmlns||s[e]||"http://www.w3.org/1999/xhtml";const r=document.createElementNS(a,e);return Object.entries(t||{}).forEach(([e,t])=>{(e="className"===e?"class":e).startsWith("on")&&e.toLowerCase()in window?r.addEventListener(e.toLowerCase().substring(2),t):r.setAttribute(e,String(t))}),i.forEach(e=>{!function t(i,e){Array.isArray(e)?e.forEach(e=>t(i,e)):i.append(e)}(r,e)}),r}function Y(e,t){return t=t||Spicetify.Locale.getLocale(),r[t]?r[t][e]||e:Y(e,a)}function K(e,t){e=e.clientX-t.getBoundingClientRect().left;return Math.min(Math.max(e/t.clientWidth,0),1)}function $(e){var t;return!e||!e.match(/\d/)||3<(t=e.split(":")).length||(t=1e3*(3600*(2<t.length?n(t[t.length-3]):0)+60*(1<t.length?n(t[t.length-2]):0)+n(t[t.length-1])),console.log("TIME",e,t),isNaN(t))?null:t}function G(e){var t;return!e||!e.match(/\d/)||(t=n(e.replace("%",""))/100,console.log("PERCENT",e,t),isNaN(t))?null:t}(async()=>{var e;document.getElementById("skipDafterDtimestamp")||((e=document.createElement("style")).id="skipDafterDtimestamp",e.textContent=String.raw`
  .skip-after-timestamp-marker{position:absolute;height:15px;width:15px;left:calc(var(--skip-after-timestamp-playback-left) + var(--skip-after-timestamp-progress) * (var(--skip-after-timestamp-playback-right) - var(--skip-after-timestamp-playback-left)));top:calc((var(--skip-after-timestamp-playback-top) + var(--skip-after-timestamp-playback-bottom))/ 2);--skip-after-timestamp-progress:var(--skip-after-timestamp-set);transform:translate(-5px,-50%);z-index:1;overflow:visible;transition:left .25s,transform 50ms}.skip-after-timestamp-marker.skip-after-timestamp-overflow:not(.skip-after-timestamp-dragging){left:var(--skip-after-timestamp-playback-right);top:var(--skip-after-timestamp-playback-top);transform:translate(-50%,-150%)}.skip-after-timestamp-marker.skip-after-timestamp-overflow:not(.skip-after-timestamp-dragging) .skip-after-timestamp-container{background-color:gray}.skip-after-timestamp-marker.skip-after-timestamp-dont-skip-this-playback .skip-after-timestamp-container{background-color:gray}.skip-after-timestamp-marker:not(.skip-after-timestamp-active):not(.skip-after-timestamp-dragging){display:none}.skip-after-timestamp-marker.skip-after-timestamp-dragging{transition:none;--skip-after-timestamp-progress:var(--skip-after-timestamp-drag)}.skip-after-timestamp-marker:hover{cursor:pointer}.skip-after-timestamp-marker:hover .skip-after-timestamp-button{background-color:rgba(0,0,0,.2)}.skip-after-timestamp-marker:active .skip-after-timestamp-button{background-color:rgba(0,0,0,.4)}.skip-after-timestamp-marker .skip-after-timestamp-button{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' role='img' aria-hidden='true' viewBox='0 0 16 16' fill='white'><path d='M12.7 1a.7.7 0 0 0-.7.7v5.15L2.05 1.107A.7.7 0 0 0 1 1.712v12.575a.7.7 0 0 0 1.05.607L12 9.149V14.3a.7.7 0 0 0 .7.7h1.6a.7.7 0 0 0 .7-.7V1.7a.7.7 0 0 0-.7-.7h-1.6z'/></svg>")}.skip-after-timestamp-marker.skip-after-timestamp-dont-skip-this-playback .skip-after-timestamp-button,.skip-after-timestamp-marker.skip-after-timestamp-overflow .skip-after-timestamp-button{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' role='img' aria-hidden='true' viewBox='0 0 16 16' fill='white'><path d='M3 1.713a.7.7 0 0 1 1.05-.607l10.89 6.288a.7.7 0 0 1 0 1.212L4.05 14.894A.7.7 0 0 1 3 14.288V1.713z'/></svg>")}.skip-after-timestamp-container{background-color:#4687d6;filter:drop-shadow(0 0 6px var(--spice-shadow));transition:background-color .25s;height:100%;width:100%}.skip-after-timestamp-button{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:calc(100% - 4px);height:calc(100% - 4px);border-radius:0;background-color:transparent;border:none;display:flex;justify-content:center;align-items:center;color:#fff}.skip-after-timestamp-input{width:55px;background-color:transparent;border:none;text-align:center}.skip-after-timestamp-input:focus{border-bottom:1px solid #fff;text-align:left}
      `.trim(),document.head.appendChild(e))})()}();